<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
  <head th:fragment="head(title)">
    <meta charset="UTF-8" />
    <title th:text="${title}">Evaluation System</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Latest compiled and minified CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <!-- Latest compiled JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <!--  Jquery  -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>

    <script>
      // Create Toast message
      function createToast(type, message) {
        if (type == "info") {
          $("#info_toast div.toast-body").html(message);

          $("#info_toast").addClass("show");

          setTimeout(function () {
            $("#info_toast").removeClass("show");
          }, 5000);
        } else if (type == "warning") {
          $("#warning_toast div.toast-body").html(message);

          $("#warning_toast").addClass("show");

          setTimeout(function () {
            $("#warning_toast").removeClass("show");
          }, 5000);
        } else if (type == "danger") {
          $("#danger_toast div.toast-body").html(message);

          $("#danger_toast").addClass("show");

          setTimeout(function () {
            $("#danger_toast").removeClass("show");
          }, 5000);
        }
      }
    </script>
    <style>
      #navbarNav ul li a {
        font-weight: 500;
      }
      #navbarNav ul li:hover {
        background-color: #247ed1;
        transition: 0.5s ease;
      }
      #navbarNav ul li:hover a {
        color: #fff !important;
      }

      .navbar-brand {
        padding: 12px 0px;
      }
    </style>
  </head>
  <body>
    <!-- Header -->
    <header th:fragment="header">
      <nav
        class="navbar navbar-expand-lg text-bg-white fw-bold shadow-sm py-0 mb-2"
      >
        <div class="ms-5 container-fluid">
          <a class="navbar-brand" href="/">
            <img
              src="./logo.png"
              alt="Logo"
              height="32"
              class="d-inline-block align-text-top"
            />
          </a>
          <button
            class="navbar-toggler"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#navbarNav"
            aria-controls="navbarNav"
            aria-expanded="false"
            aria-label="Toggle navigation"
          >
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav">
              <li class="nav-item p-2">
                <a
                  class="nav-link active"
                  aria-current="page"
                  href="/"
                  th:text="#{header.home}"
                  >Home</a
                >
              </li>
              <li class="nav-item p-2">
                <a
                  class="nav-link active"
                  href="/department"
                  th:href="@{/department}"
                  th:text="#{header.department}"
                  >Department</a
                >
              </li>
              <li class="nav-item p-2">
                <a
                  class="nav-link active"
                  href="/employee"
                  th:href="@{/employee}"
                  th:text="#{header.employee}"
                  >Employee</a
                >
              </li>
            </ul>

            <div class="navbar-nav ms-auto">
              <div class="nav-item p-2">
                <a
                  class="nav-link"
                  href="/logout"
                  th:href="@{/logout}"
                  th:text="#{header.logout}"
                  >Logout</a
                >
              </div>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <!-- Content -->
    <div class="mx-4">
           <!-- Header content -->
           <div class="pt-2 d-flex">
            <h2 class="ps-3 pt-2">Wireguard Connection</h2>
            <div class="btn-group-import-export ms-auto">
              <button
                type="button"
                class="btn btn-primary ms-3 btn-import"
                data-bs-toggle="modal"
                data-bs-target="#create_course_modal" 
              >
                New Course
              </button>
            </div>
          </div>
      <!-- Main content -->

      <div class="mt-4">
        <div th:fragment="simple_table(data)" id="simple_table">
          <table class="table table-striped table-bordered text-nowrap">
            <thead class="text-bg-success">
              <tr>
                <th scope="col">STT</th>
                <th scope="col">Title</th>
                <th scope="col">Description</th>
                <th scope="col">Current Enrollment</th>
                <th scope="col">Max Enrollment</th>
                <th scope="col">Started Date</th>
                <th scope="col">Teacher</th>
                <th scope="col">Duration</th>
                <th scope="col">Action</th>
              </tr>
            </thead>
            <tbody class="table-group-divider">
              <tr th:each="searchResult : ${data.getContent()}">
                <th scope="row" th:text="${searchResult.searchKeyword}">
                  Việt Nam
                </th>
                <td>
                  <span
                    th:each="kw : ${searchResult.matchKeywords.split(', ')}"
                  >
                    <span th:text="${kw}"></span><br />
                  </span>
                </td>
                <td class="text-truncate" style="max-width: 200px;"
                  th:text="${searchResult.platform.name() + (searchResult.isPC ? ' - PC' : ' - Mobile')}"
                  title="Đây là một đoạn văn bản rất dài mà sẽ bị cắt nếu vượt quá chiều rộng."
                >
                  GOOGLE lkjasfd lkasjfd lkas lksafjlksa lksafjlksaflaskf lsakfd sà
                </td>
                <td
                  th:text="${searchResult.isAllMatch ? 'All Match' : 'Partial Match'}"
                >
                  Partial Match
                </td>
                <td th:text="${searchResult.remark}"></td>
                <td th:text="${searchResult.remark}"></td>
                <td th:text="${searchResult.remark}"></td>

                <td
                  th:each="day : ${#numbers.sequence(1, daysInMonth)}"
                  class="text-center"
                >
                  <div th:each="result, iter : ${searchResult.searchResults}">
                    <div th:if="${result.createdAt.dayOfMonth == day}">
                      <div
                        th:if="${iter.last || searchResult.searchResults[iter.index + 1].createdAt.dayOfMonth != day}"
                      >
                        <a
                          href="javascript:void(0)"
                          th:data-image="${'/screenshots/' + result.urlScreenshot}"
                          class="modal-link-image text-decoration-none"
                        >
                          <span th:if="${result.isMatchFound}">
                            <i class="bi bi-check-circle-fill"></i
                          ></span>
                          <span th:unless="${result.isMatchFound}"
                            ><strong>-</strong></span
                          >
                        </a>
                      </div>
                    </div>
                  </div>
                </td>
                <td th:text="${searchResult.remark}">
                    <button
                      type="button"
                      th:data-id="${evaluation.id}"
                      th:data-iscommended="${evaluation.isCommended}"
                      th:data-reason="${evaluation.reason}"
                      class="btn btn-primary btn-update-evaluation"
                      data-bs-toggle="modal"
                      data-bs-target="#update_course_modal"
                      th:text="#{button.update}"
                    >
                      Update
                    </button>
                    <button
                      th:onclick="|deleteEvaluationById(${evaluation.id})|"
                      type="button"
                      class="btn btn-danger"
                      th:text="#{button.delete}"
                    >
                      Delete
                    </button>
                  </td>
              </tr>
            </tbody>
          </table>
          <nav aria-label="Page navigation">
            <ul class="pagination">
              <li
                class="page-item"
                th:class="${evaluationPage.hasPrevious() ? '' : 'disabled'}"
              >
                <a
                  class="page-link"
                  th:href="@{/evaluation(page=${evaluationPage.number - 1})}"
                  th:if="${evaluationPage.hasPrevious()}"
                  th:text="#{pagination.previous}"
                  >Previous</a
                >
              </li>

              <li
                class="page-item"
                th:if="${evaluationPage.totalPages > 0}"
                th:each="i : ${#numbers.sequence(0, evaluationPage.totalPages - 1)}"
                th:class="${i == evaluationPage.number ? 'active' : ''}"
              >
                <a
                  class="page-link"
                  th:href="@{/evaluation(page=${i})}"
                  th:text="${i + 1}"
                  >1</a
                >
              </li>

              <li
                class="page-item"
                th:class="${evaluationPage.hasNext() ? '' : 'disabled'}"
              >
                <a
                  class="page-link"
                  th:href="@{/evaluation(page=${evaluationPage.number + 1})}"
                  th:if="${evaluationPage.hasNext()}"
                  th:text="#{pagination.next}"
                  >Next</a
                >
              </li>
            </ul>
          </nav>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <footer
      class="bg-body-tertiary text-center text-lg-start"
      th:fragment="footer"
    >
      <!-- Copyright -->
      <div
        class="text-center p-3"
        style="background-color: rgba(0, 0, 0, 0.05)"
      >
        © 2024 Copyright:
        <a class="text-body" href="https://vietis.com.vn/">VietIS.com.vn</a>
      </div>
      <!-- Copyright -->
    </footer>
    <div
      class="position-fixed top-0 end-0 p-3"
      th:fragment="toast"
      style="z-index: 11"
    >
      <div
        id="info_toast"
        class="toast align-items-center text-bg-primary border-0 text-wrap fw-bolder"
        role="alert"
        aria-live="assertive"
        aria-atomic="true"
      >
        <div class="d-flex">
          <div class="toast-body">Hello, world! This is a toast message.</div>
          <button
            type="button"
            class="btn-close btn-close-white me-2 m-auto"
            data-bs-dismiss="toast"
            aria-label="Close"
          ></button>
        </div>
      </div>

      <div
        id="warning_toast"
        class="toast align-items-center text-bg-warning border-0 text-wrap fw-bolder"
        role="alert"
        aria-live="assertive"
        aria-atomic="true"
      >
        <div class="d-flex">
          <div class="toast-body">Hello, world! This is a toast message.</div>
          <button
            type="button"
            class="btn-close btn-close-white me-2 m-auto"
            data-bs-dismiss="toast"
            aria-label="Close"
          ></button>
        </div>
      </div>

      <div
        id="danger_toast"
        class="toast align-items-center text-bg-danger border-0 text-wrap fw-bolder"
        role="alert"
        aria-live="assertive"
        aria-atomic="true"
      >
        <div class="d-flex">
          <div class="toast-body">Hello, world! This is a toast message.</div>
          <button
            type="button"
            class="btn-close btn-close-white me-2 m-auto"
            data-bs-dismiss="toast"
            aria-label="Close"
          ></button>
        </div>
      </div>
    </div>

    <!-- Modal -->
     <!-- Create course modal -->
     <div class="modal fade" id="create_course_modal" th:fragment="create_course">
        <div class="modal-dialog">
            <div class="modal-content">
    
                <div class="modal-header text-bg-primary">
                    <h4 class="modal-title" th:text="#{account.modalCreateAccount.title}">Create User Account</h4>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <form method="post" name="create_user_form" id="create_user_form" novalidate="novalidate">
                    <div class="modal-body">
                        <!-- Username -->
                        <div class="form-group">
                            <label for="username" class="control-label" th:text="#{account.modalCreateAccount.username}">Username</label>
                            <input type="text" class="form-control" id="username" name="username" minlength="5" required value="">
                        </div>
                        <!--  Password -->
                        <div class="form-group">
                            <label for="password" class="control-label" th:text="#{account.modalCreateAccount.password}">New Password</label>
                            <input type="password" class="form-control" id="password" name="password" minlength="5" required value="">
                        </div>
                    </div>
    
                    <div class="modal-footer justify-content-between">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" th:text="#{button.cancel}">Cancel</button>
                        <button type="submit" class="btn btn-primary" data-bs-dismiss="modal" id="btn_submit_create_user" th:text="#{button.submit}">Submit</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Update course modal -->
    <div class="modal fade" id="update_course_modal" th:fragment="update_course">
        <div class="modal-dialog">
            <div class="modal-content">
    
                <div class="modal-header text-bg-primary">
                    <h4 class="modal-title" th:text="#{account.modalupdateAccount.title}">Update User Account</h4>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <form method="post" name="update_user_form" id="update_user_form" novalidate="novalidate">
                    <div class="modal-body">
                        <!-- Username -->
                        <div class="form-group">
                            <label for="username" class="control-label" th:text="#{account.modalupdateAccount.username}">Username</label>
                            <input type="text" class="form-control" id="username" name="username" minlength="5" required value="">
                        </div>
                        <!--  Password -->
                        <div class="form-group">
                            <label for="password" class="control-label" th:text="#{account.modalupdateAccount.password}">New Password</label>
                            <input type="password" class="form-control" id="password" name="password" minlength="5" required value="">
                        </div>
                    </div>
    
                    <div class="modal-footer justify-content-between">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" th:text="#{button.cancel}">Cancel</button>
                        <button type="submit" class="btn btn-primary" data-bs-dismiss="modal" id="btn_submit_update_user" th:text="#{button.submit}">Submit</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
  </body>
</html>
